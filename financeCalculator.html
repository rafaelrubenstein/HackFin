<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Finance Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <!-- font awesome allows me to insert any icon they have for free-->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script src="https://kit.fontawesome.com/5d3897d384.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="../styles/blogstyle.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Open+Sans&display=swap" rel="stylesheet">


<script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous"></script>

<style>

#InputDiv{
float:left;
padding-top: 20px;
padding-bottom: 20px;
 width: 100%;
 overflow: hidden;
}
table {
  font-family: arial, sans-serif;
  border-collapse: collapse;
  width: 100%;
}

td, th {
  border: 1px solid black;
  text-align: left;
  padding: 8px;
}

tr:nth-child(even) {
  background-color: #dddddd;
}



body {font-family: Arial, Helvetica, sans-serif;}

/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
</style>

</head>
<body>
    <nav class="navbar navbar-expand navbar-light">
      <a class="navbar-brand" href="index.html">
        <span class="fa-layers fa-fw" style="font-size: 1.5em; color: #196b2e;">
        <i class="fa-solid fa-money-bill-1-wave fa-2x"></i>
      </span>
    </a>
        <!-- here is the navbar items-->
        <ul class="nav nav-fill">
          <li class="nav-item">
            <a class="nav-link" href="index.html">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="financeCalculator.html">Financial Calculator</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="piechartgen.html">Pie Chart</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="blogs.html">Blog</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="contactUs.html">Contact Us</a>
          </li>
        </ul>
    </nav>


<div id="CoreDiv">
 <!-- May add a new div that will hold a help button on top-->
<!-- input feilds for user data-->
<div id="InputDiv">

<!-- User income-->
  <label for="income">Income: </label>
  <input type="text" min="0"   onfocus="this.value=''" id="income" data-type="currency" placeholder="0" ><br><br>

  <!-- User 401k deposit-->
  <label for="age">401k: </label>
  <input type="text" min="0"   onfocus="this.value=''" id="401k" data-type="currency" placeholder="0" ><br><br>

    <!-- UserTax deductables-->
  <label for="deduct">Tax deductables: </label>
  <input type="text" min="0"  onfocus="this.value=''" id="deduct" data-type="currency" placeholder="0" ><br><br>

   <!-- User IRA contributions-->
    <label for="duc">IRA contributions: </label>

     <input type="text"   onfocus="this.value=''" min="0" id="ira" data-type="currency" placeholder="0" ><br><br>

      <label for="status">Maritall Status: </label>
   <!-- User Marital filling status-->
  <select name="Status" id="status">
    <option value="1">single / married filing single</option>
    <option value="3">Head of the house hold</option>
     <option value="2">married</option>
  </select>
<br>
<br>
<!-- Trigger/Open The Modal -->
<button id="hlpbtn">Help</button>

<br>
<br>
<button id="mainb" onclick="displayMessage()">Submit</button>
<br>
</div>

<div id="OutputDiv">

 <!-- Table fo the out puts-->
<table>
  <tr> <!-- First row-->

    <th></th>
     <th>Bracket</th>
      <th> Percentage</th>
       <th>Dollar amount</th>
  </tr>
  <tr><!-- Second row-->
    <td class="black">Goverment tax</td>
    <td><p id="ChartGVB"></p></td>
    <td><p id="ChartGVP"></p></td>
    <td><p id="ChartGVD"></p></td>
  </tr>
  <tr>  <!-- Third row-->
    <td class="white">NY State tax</>
    <td><p id="ChartSTB"></p></td>
    <td><p id="ChartSTP"></td>
    <td><p id="ChartSTD"></td>
  </tr>
  <tr><!-- Fourth row-->
    <td class="black">NY City tax</td>
    <td><p id="ChartCTB"></td>
    <td><p id="ChartCTP"></td>
    <td><p id="ChartCTD"></td>
  </tr>
  <tr> <!-- Fifth row-->
    <td class="white">Total tax</td>
    <td></td>
    <td><p id="ChartTTP"></td>
    <td><p id="ChartTTD"></td>
  </tr>
  <tr>  <!-- Sixth row-->
    <td class="black">Total Amount Kept</>
    <td></td>
    <td><p id="ChartAKP"></td>
    <td><p id="ChartAKD"></td>
  </tr>

</table>

</div>


</div>



<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content">
    <span class="close">&times;</span>
    <p>This is a tax calculator: it will calculate the total amount of income taxes owed for a New York City Resident. It will break it down by which entity's tax. As well as show the bracket, the percentage tha is takens and dollar amount taken</p>
        <p><b>Income :</b> Your total pre taxed yearly income.</p>
         <br><p> <i> *The other values can be left empty, if you dont know the values</i> </p>
        <p><b>401k:</b> The amount you put in your 401k, you can check your paychecks for the value </p>
                <p><b>IRA contributions:</b> This is like your 401k but it is done by yourself not your company</p>
                 <p><b>Tax Deductables:</b> This is for any other tax deductables you know you have </p>
                  <p><i>* This calculator will not give a value if the amount owed is negative or zero</i> </p>
  </div>

</div>


<script>
var STtax =0; // State owed tax
var CTtax =0; // City owed tax
var GVtax =0; // Gov owed tax
var TOtax =0; // Total owed tax

var STtaxper =0; // State tax percentage
var CTtaxper =0; // City tax percentage
var GVtaxper =0; // Gov tax percentage
var TOtaxper =0; // Total tax percentage

var STbracket =0; // State Tax bracket
var CTbracket =0;  // City Tax bracket
var GVbracket =0;  // Gov Tax bracket

var taxableincome =0; // the income after decutalbles

var income=0; // totoal income from the inputdata
var k104=0;
var ira=0;
var taxdedu=0;
var lost =0; // all the deductables.
var status = document.getElementById('status').value; // maritalable status


 // Federal singel tax bracket
 var GVStaxB = [];
  GVStaxB[0] =0;
 GVStaxB[1] =9950;
 GVStaxB[2]= 40525;
 GVStaxB[3]= 86375;
 GVStaxB[4]= 164925;
 GVStaxB[5]= 209425;
 GVStaxB[6]= 523600;

 // Federal married tax bracket
  var GVMtaxB = [];
  GVMtaxB[0] =0;
 GVMtaxB[1] =19900;
 GVMtaxB[2]= 81050;
 GVMtaxB[3]= 172750;
 GVMtaxB[4]= 329850;
 GVMtaxB[5]= 418850;
 GVMtaxB[6]= 628300;

 // Federal head tax bracket
 var GVHtaxB = [];
  GVHtaxB[0]= 0;
 GVHtaxB[1] =14200;
 GVHtaxB[2]= 54200;
 GVHtaxB[3]= 86350;
 GVHtaxB[4]= 164900;
 GVHtaxB[5]= 209400;
 GVHtaxB[6]= 523600;

 // Federal  tax percentage
  var GVtaxP = [];
   GVtaxP[0] = 0;
 GVtaxP[1] = 0.10;
 GVtaxP[2]= .12;
 GVtaxP[3]= .22;
 GVtaxP[4]= .24;
 GVtaxP[5]= .32;
 GVtaxP[6]= .35;
 GVtaxP[7]= .37;

 //nys single tax bracket
 var STStaxB = [];
 STStaxB[0]= 0;
STStaxB[1] =8500 ;
 STStaxB[2]= 11700;
 STStaxB[3]= 13900;
 STStaxB[4]= 21400;
 STStaxB[5]= 80650;
 STStaxB[6]= 215400;
 STStaxB[7]= 1077550;
  STStaxB[8]= 5000000;
  STStaxB[9]= 25000000;

   //nys married tax bracket
   var STMtaxB = [];
  STMtaxB[0]= 0;
STMtaxB[1] =17150 ;
 STMtaxB[2]= 23600;
 STMtaxB[3]= 27900;
 STMtaxB[4]= 43000;
 STMtaxB[5]= 161550;
 STMtaxB[6]= 323200;
 STMtaxB[7]= 2155350;
  STMtaxB[8]= 5000000;
  STMtaxB[9]= 25000000;

   //nys head tax bracket
   var STHtaxB = [];
  STHtaxB[0]=0 ;
STHtaxB[1] = 12800;
 STHtaxB[2]= 17650;
 STHtaxB[3]= 20900;
 STHtaxB[4]= 32200;
 STHtaxB[5]=107650 ;
 STHtaxB[6]= 269300;
 STHtaxB[7]= 1616450;
  STHtaxB[8]=5000000 ;
  STHtaxB[9]=25000000 ;

 //nys  tax percentage
 var STtaxP = [];
 STtaxP[0] =0;
  STtaxP[1] =.04;
 STtaxP[2]= .045;
 STtaxP[3]= .0525;
 STtaxP[4]= .059;
 STtaxP[5]= .0597;
 STtaxP[6]= .0633;
 STtaxP[7]= .0685;
  STtaxP[8]= .0965;
  STtaxP[9]= .1030;
  STtaxP[10]= .1090;

  //nyc single tax brackets
    var CTStaxB = [];
  CTStaxB[0]= 0;
 CTStaxB[1] =12000;
 CTStaxB[2]= 25000;
 CTStaxB[3]= 50000;

   //nyc married tax brackets
 var CTMtaxB = [];
  CTMtaxB[0]= 0;
 CTMtaxB[1] =21600;
 CTMtaxB[2]= 45000;
 CTMtaxB[3]= 90000;

   //nyc head tax brackets
 var CTHtaxB = [];
  CTHtaxB[0]= 0;
 CTHtaxB[1] =14400;
 CTHtaxB[2]= 30000;
 CTHtaxB[3]= 60000;


    //nyc  tax percentage
   var CTtaxP = [];
    CTtaxP[0]= 0;
 CTtaxP[1] =.03078;
 CTtaxP[2]= .03762;
 CTtaxP[3]= .03819;
 CTtaxP[4]= .03867;

 //prints out the ouput to the screen.
function displayMessage(){

//get user information from the feilds
//gets income
if(document.getElementById("income").value.replace(/,/g, '')){
income = document.getElementById("income").value.replace(/,/g, '');
}else{
income = 0;
}


//get marital status
status =document.getElementById('status').value;

// get total tax decutable

if(document.getElementById("401k").value.replace(/,/g, '')){
k104 = document.getElementById("401k").value.replace(/,/g, '');
}else{
k104 = 0;
}

if(document.getElementById("ira").value.replace(/,/g, '')){
ira = document.getElementById("ira").value.replace(/,/g, '');
}else{
ira = 0;
}

if(document.getElementById("deduct").value.replace(/,/g, '')){
taxdedu = document.getElementById("deduct").value.replace(/,/g, '');
}else{
taxdedu = 0;
}

lost = (parseInt(k104) + parseInt(ira)+ parseInt(taxdedu));
//lost =parseInt ( document.getElementById("401k").value) +  parseInt (document.getElementById("deduct").value) + parseInt ( document.getElementById("ira").value );

// resets the total tax amount
TOtax =0;

// callculate the the income that can be taxed
 taxableincome = (income - lost);


//check which function to used bade pn maritable status
    if (status ==3){// head of house hold
    GVtaxcal(GVHtaxB,GVtaxP);
       STtaxcal(STHtaxB,STtaxP);
         CTtaxcal(CTHtaxB,CTtaxP);

    }else if(status ==2){// married
    GVtaxcal(GVMtaxB,GVtaxP);
       STtaxcal(STMtaxB,STtaxP);
         CTtaxcal(CTMtaxB,CTtaxP);

    } else{// single
    GVtaxcal(GVStaxB,GVtaxP);
       STtaxcal(STStaxB,STtaxP);
         CTtaxcal(CTStaxB,CTtaxP);

    }

    //calculate total tax by adding city, state, and federal tax
   TOtax =(GVtax + STtax + CTtax);




document.getElementById('ChartGVB').innerHTML =( GVbracket);
document.getElementById('ChartGVP').innerHTML =( GVtax/taxableincome).toFixed(4);
document.getElementById('ChartGVD').innerHTML =( GVtax).toFixed(2);

document.getElementById('ChartSTB').innerHTML =( STbracket);
document.getElementById('ChartSTP').innerHTML =( STtax/taxableincome).toFixed(4);
document.getElementById('ChartSTD').innerHTML =( STtax).toFixed(2);

document.getElementById('ChartCTB').innerHTML =( CTbracket);
document.getElementById('ChartCTP').innerHTML =( CTtax /taxableincome).toFixed(4);
document.getElementById('ChartCTD').innerHTML =( CTtax).toFixed(2);

document.getElementById('ChartTTP').innerHTML =( ( TOtax /taxableincome).toFixed(4));
document.getElementById('ChartTTD').innerHTML =( TOtax).toFixed(2);

document.getElementById('ChartAKP').innerHTML =( (1-( TOtax /taxableincome)).toFixed(4));
document.getElementById('ChartAKD').innerHTML =( (taxableincome -TOtax) .toFixed(2));


}
// function that callculate federal tax rate. (gov tax braket array , (gov tax percentage array )
function GVtaxcal(taxb,taxp){
 //reset starting values
 GVtax =0;
  GVtaxper =0;
  GVbracket =0;

  // loops through all tax bracket untill it find the one it falls under
for (var i = 0; i < taxb.length; i++) {
if(taxableincome < taxb[i]){ // find correct tax bracket
 GVtax = (taxableincome - taxb[i-1]) *taxp[i] + pretaxcal(taxb,taxp,i); // sets tax owed, adds lower tax brackets with a function
    GVtaxper = taxp[i]; //sets tax percentage
    GVbracket =i; // sets tax bracket
      i = taxb.length+1; // breaks the loop
 }
}
// calculat tax for the highest tax bracket
if(taxableincome > taxb[taxb.length-1]){
 GVtax = (taxableincome - taxb[taxb.length-1]) *taxp[ taxp.length-1]  + pretaxcal(taxb,taxp,length-1);// sets tax owed, adds lower tax brackets with a function
    GVtaxper = taxp[ taxp.length-1]; //sets tax percentage
    GVbracket = taxp.length-1; // sets tax bracket
 }
}

// function that callculate State tax rate. (State tax braket array
//, (state tax percentage array )
function STtaxcal(taxb,taxp){
 //reset starting values
STtax =0;
STtaxper =0;
STbracket =0;

 // loops through all tax bracket untill it find the one it falls under
for (var i = 0; i < taxb.length; i++) {
if(taxableincome < taxb[i]){ // find correct tax bracket
 STtax = (taxableincome - taxb[i-1]) *taxp[i] + pretaxcal(taxb,taxp,i); // sets tax owed, adds lower tax brackets with a pretaxcal function

     STtaxper = taxp[i]; //sets tax percentage
    STbracket =i;  // sets tax bracket
      i = taxb.length+1;  // breaks the loop
 }
}
// calculat tax for the highest tax bracket
if(taxableincome > taxb[taxb.length-1]){
 STtax = (taxableincome - taxb[taxb.length-1]) *taxp[ taxp.length-1]; // sets tax owed, adds lower tax brackets with pretaxcal function
    STtaxper = taxp[ taxp.length-1]; //sets tax percentage
    STbracket = taxp.length-1; // sets tax bracket

 }
}

// function that callculate City tax rate. (City tax braket array
//, (City tax percentage array )
function CTtaxcal(taxb,taxp){
//reset starting values
CTtax =0;
CTtaxper =0;
CTbracket =0;

// loops through all tax bracket untill it find the one it falls under
for (var i = 0; i < taxb.length; i++) {
if(taxableincome < taxb[i]){// find correct tax bracket
 CTtax = (taxableincome - taxb[i-1]) *taxp[i] + pretaxcal(taxb,taxp,i); // sets tax owed, adds lower tax brackets with a pretaxcal function

    CTtaxper = taxp[i]; //sets tax percentage
    CTbracket =i; // sets tax bracket
      i = taxb.length+1;  // breaks the loop
 }
}
// calculat tax for the highest tax bracket
if(taxableincome > taxb[taxb.length-1]){
 CTtax = (taxableincome - taxb[taxb.length-1]) *taxp[ taxp.length-1]; // sets tax owed, adds lower tax brackets with pretaxcal function
    CTtaxper = taxp[ taxp.length-1]; //sets tax percentage
    CTbracket = taxp.length-1; // sets tax bracket
 }
}

// calculate the tax need from the lower brakets
//, type of tax brackets, type of tax perentage, the bracke the tax fall in -1
function pretaxcal(taxb , taxp, i){
var temp =0;
//loops through the lower brackets
for (var j = 0; j < i; j++) {
temp = (taxb[j] * taxp[j])+temp; // adds all the brackets toaol tax  together
}

return temp; // gives the lower tax brackets value
}


// Jquery Dependency

$("input[data-type='currency']").on({
    keyup: function() {
      formatCurrency($(this));
    },
    blur: function() {
      formatCurrency($(this), "blur");
    }
});


function formatNumber(n) {
  // format number 1000000 to 1,234,567
  return n.replace(/\D/g, "").replace(/\B(?=(\d{3})+(?!\d))/g, ",")
}


function formatCurrency(input, blur) {
  // appends $ to value, validates decimal side
  // and puts cursor back in right position.

  // get input value
  var input_val = input.val();

  // don't validate empty input
  if (input_val === "") { return; }

  // original length
  var original_len = input_val.length;

  // initial caret position
  var caret_pos = input.prop("selectionStart");

  // check for decimal
  if (input_val.indexOf(".") >= 0) {

    // get position of first decimal
    // this prevents multiple decimals from
    // being entered
    var decimal_pos = input_val.indexOf(".");

    // split number by decimal point
    var left_side = input_val.substring(0, decimal_pos);
    var right_side = input_val.substring(decimal_pos);

    // add commas to left side of number
    left_side = formatNumber(left_side);

    // validate right side
    right_side = formatNumber(right_side);

    // On blur make sure 2 numbers after decimal
    if (blur === "blur") {
      right_side += "00";
    }

    // Limit decimal to only 2 digits
    right_side = right_side.substring(0, 2);

    // join number by .
    input_val = left_side + "." + right_side;

  } else {
    // no decimal entered
    // add commas to number
    // remove all non-digits
    input_val = formatNumber(input_val);
    input_val =  input_val;

    // final formatting
    if (blur === "blur") {
      input_val += ".00";
    }
  }

  // send updated string to input
  input.val(input_val);

  // put caret back in the right position
  var updated_len = input_val.length;
  caret_pos = updated_len - original_len + caret_pos;
  input[0].setSelectionRange(caret_pos, caret_pos);
}


// Get the modal
var modal = document.getElementById("myModal");

// Get the button that opens the modal
var btn = document.getElementById("hlpbtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal
btn.onclick = function() {
  modal.style.display = "block";
}

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}
</script>
</body>
</html>
